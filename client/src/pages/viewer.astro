---

---

<!doctype html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>DICOM Viewer - Visor M√©dico</title>
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap"
    />
  </head>
  <body>
    <!-- Toolbar Superior -->
    <div class="toolbar">
      <div class="toolbar-left">
        <button class="tool-btn" title="Levels">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M12 8v8M8 12h8"></path>
          </svg>
          <span>Levels</span>
        </button>
        <button class="tool-btn" title="Zoom & Pan">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="11" cy="11" r="8"></circle>
            <path d="m21 21-4.35-4.35"></path>
            <line x1="11" y1="8" x2="11" y2="14"></line>
            <line x1="8" y1="11" x2="14" y2="11"></line>
          </svg>
          <span>Zoom & Pan</span>
        </button>
        <div class="draw-tool-container">
          <button class="tool-btn draw-btn" title="Draw">
            <svg
              width="20"
              height="20"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <path d="M12 19l7-7 3 3-7 7-3-3z"></path>
              <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z"></path>
              <path d="M2 2l7.586 7.586"></path>
              <circle cx="11" cy="11" r="2"></circle>
            </svg>
            <span>Draw</span>
            <svg
              class="dropdown-arrow"
              width="12"
              height="12"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <polyline points="6 9 12 15 18 9"></polyline>
            </svg>
          </button>
          <div class="draw-shapes-menu">
            <button class="shape-option" data-shape="Arrow">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <line x1="5" y1="12" x2="19" y2="12"></line>
                <polyline points="12 5 19 12 12 19"></polyline>
              </svg>
              <span>Arrow</span>
            </button>
            <button class="shape-option" data-shape="Ruler">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path
                  d="M21.42 6.11l-3.53-3.53a1 1 0 0 0-1.42 0L2.58 16.47a1 1 0 0 0 0 1.42l3.53 3.53a1 1 0 0 0 1.42 0L21.42 7.53a1 1 0 0 0 0-1.42z"
                ></path>
                <path d="M10.41 10.59l1.42 1.42"></path>
                <path d="M13.41 7.59l1.42 1.42"></path>
              </svg>
              <span>Ruler</span>
            </button>
            <button class="shape-option" data-shape="Circle">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <circle cx="12" cy="12" r="10"></circle>
              </svg>
              <span>Circle</span>
            </button>
            <button class="shape-option" data-shape="Ellipse">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <ellipse cx="12" cy="12" rx="10" ry="6"></ellipse>
              </svg>
              <span>Ellipse</span>
            </button>
            <button class="shape-option" data-shape="Rectangle">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect>
              </svg>
              <span>Rectangle</span>
            </button>
            <button class="shape-option" data-shape="Protractor">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M12 2a10 10 0 0 0-10 10h20a10 10 0 0 0-10-10z"></path>
                <line x1="12" y1="12" x2="18" y2="6"></line>
              </svg>
              <span>Protractor</span>
            </button>
            <button class="shape-option" data-shape="Roi">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <polygon points="12 2 2 7 12 12 22 7 12 2"></polygon>
                <polyline points="2 17 12 22 22 17"></polyline>
                <polyline points="2 12 12 17 22 12"></polyline>
              </svg>
              <span>ROI</span>
            </button>
            <div class="menu-separator"></div>
            <button class="shape-option" data-action="clear">
              <svg
                width="16"
                height="16"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
              >
                <path d="M3 6h18"></path>
                <path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"></path>
                <path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"></path>
                <line x1="10" y1="11" x2="10" y2="17"></line>
                <line x1="14" y1="11" x2="14" y2="17"></line>
              </svg>
              <span>Limpiar todo</span>
            </button>
          </div>
        </div>
        <button class="tool-btn" title="Floodfill">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="16"></line>
            <line x1="8" y1="12" x2="16" y2="12"></line>
          </svg>
          <span>Floodfill</span>
        </button>
        <button class="tool-btn" title="Livewire">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M4 20h16"></path>
            <path d="M6 16v4"></path>
            <path d="M18 16v4"></path>
            <path d="M9 3l3 3 3-3"></path>
            <path d="M9 3h6"></path>
          </svg>
          <span>Livewire</span>
        </button>
        <button class="tool-btn" title="Reset">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"></path>
            <path d="M21 3v5h-5"></path>
            <path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"
            ></path>
          </svg>
          <span>Reset</span>
        </button>
      </div>
      <div class="toolbar-right">
        <button class="tool-btn help-btn" title="Ayuda">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <circle cx="12" cy="12" r="10"></circle>
            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
            <line x1="12" y1="17" x2="12.01" y2="17"></line>
          </svg>
          <span>Ayuda</span>
        </button>
        <button class="tool-btn close-btn" title="Close">
          <svg
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
          >
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
    </div>

    <!-- Contenedor Principal -->
    <div class="viewer-container">
      <!-- Sidebar con miniaturas -->
      <div class="thumbnails-sidebar">
        <div class="sidebar-header">
          <button class="sidebar-toggle">
            <svg
              width="16"
              height="16"
              viewBox="0 0 24 24"
              fill="none"
              stroke="currentColor"
              stroke-width="2"
            >
              <rect x="3" y="3" width="7" height="7"></rect>
              <rect x="14" y="3" width="7" height="7"></rect>
              <rect x="3" y="14" width="7" height="7"></rect>
              <rect x="14" y="14" width="7" height="7"></rect>
            </svg>
          </button>
        </div>
        <div class="thumbnails-list">
          <div class="thumbnail-item active">
            <div class="thumbnail-preview">
              <div id="layerGroup1" class="layer-group-thumbnail"></div>
            </div>
            <div class="thumbnail-info">
              <div class="thumbnail-title">CT Scan</div>
              <div class="thumbnail-description">Series 1</div>
            </div>
          </div>
        </div>
      </div>

      <!-- √Årea de visualizaci√≥n principal -->
      <div class="main-viewer">
        <div id="dicom-viewport">
          <div id="layerGroup0" class="layer-group"></div>
        </div>

        <div class="patient-info top-left">
          <div id="patient-name"></div>
          <div id="study-date"></div>
        </div>

        <div class="patient-info top-right">
          <div id="study-description"></div>
          <div id="study-time"></div>
        </div>
      </div>
    </div>

    <!-- Modal de Ayuda -->
    <div id="help-modal" class="modal">
      <div class="modal-content">
        <div class="modal-header">
          <h2>Gu√≠a de Herramientas del Visor DICOM</h2>
          <button class="modal-close">&times;</button>
        </div>
        <div class="modal-body">
          <div class="help-section">
            <h3>üîç Herramientas de Visualizaci√≥n</h3>
            <div class="help-item">
              <strong>Levels (Ventana/Nivel):</strong>
              <p>
                Ajusta el brillo y contraste de la imagen. Haz clic y arrastra
                para modificar los niveles de ventana.
              </p>
            </div>
            <div class="help-item">
              <strong>Zoom & Pan:</strong>
              <p>
                Ampl√≠a o reduce la imagen y mu√©vela por el visor. Usa la rueda
                del rat√≥n para zoom y arrastra para mover.
              </p>
            </div>
            <div class="help-item">
              <strong>Stack Scroll:</strong>
              <p>
                Navega entre las diferentes capas de un estudio multi-corte.
                Arrastra verticalmente para cambiar de capa.
              </p>
            </div>
          </div>

          <div class="help-section">
            <h3>‚úèÔ∏è Herramientas de Anotaci√≥n</h3>
            <div class="help-item">
              <strong>Draw (Dibujar):</strong>
              <p>Despliega un men√∫ con diferentes formas para anotar:</p>
              <ul>
                <li>
                  <strong>Arrow:</strong> Dibuja flechas para se√±alar √°reas
                </li>
                <li><strong>Ruler:</strong> Mide distancias en la imagen</li>
                <li><strong>Circle/Ellipse:</strong> Marca √°reas circulares</li>
                <li><strong>Rectangle:</strong> Marca √°reas rectangulares</li>
                <li><strong>Protractor:</strong> Mide √°ngulos</li>
                <li><strong>ROI:</strong> Define regi√≥n de inter√©s</li>
              </ul>
            </div>
            <div class="help-item">
              <strong>Limpiar todo:</strong>
              <p>Elimina todas las anotaciones de la imagen actual.</p>
            </div>
          </div>

          <div class="help-section">
            <h3>üé® Herramientas Avanzadas</h3>
            <div class="help-item">
              <strong>Floodfill:</strong>
              <p>
                Rellena √°reas similares con un color. √ötil para segmentaci√≥n
                b√°sica.
              </p>
            </div>
            <div class="help-item">
              <strong>Livewire:</strong>
              <p>
                Herramienta de segmentaci√≥n inteligente que detecta bordes
                autom√°ticamente.
              </p>
            </div>
          </div>

          <div class="help-section">
            <h3>üîÑ Otras Funciones</h3>
            <div class="help-item">
              <strong>Reset:</strong>
              <p>
                Restaura la vista original: elimina zoom, pan, y todas las
                anotaciones.
              </p>
            </div>
          </div>

          <div class="help-tip">
            <strong>üí° Consejo:</strong> Puedes desactivar cualquier herramienta
            haciendo clic nuevamente en su bot√≥n.
          </div>
        </div>
      </div>
    </div>

    <script>
      import "../scripts/viewer.ts";
    </script>

    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family:
          "Roboto",
          -apple-system,
          sans-serif;
        background: #0f0f0f;
        color: #fff;
        overflow: hidden;
        height: 100vh;
        display: flex;
        flex-direction: column;
      }

      .toolbar {
        background: linear-gradient(180deg, #1a1a1a 0%, #121212 100%);
        border-bottom: 1px solid #2a2a2a;
        padding: 12px 16px;
        display: flex;
        justify-content: space-between;
        gap: 12px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      }

      .toolbar-left,
      .toolbar-right {
        display: flex;
        gap: 8px;
        align-items: center;
      }

      .tool-btn {
        background: rgba(40, 40, 40, 0.7);
        border: 1px solid #333;
        color: #ccc;
        padding: 8px 12px;
        border-radius: 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 13px;
        font-weight: 500;
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .tool-btn:hover {
        background: linear-gradient(180deg, #2a2a2a 0%, #1f1f1f 100%);
        border-color: #555;
        color: #fff;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }

      .tool-btn.active {
        background: linear-gradient(180deg, #0d6efd 0%, #0b5ed7 100%);
        border-color: #0b5ed7;
        color: #fff;
        box-shadow: 0 2px 6px rgba(13, 110, 253, 0.4);
      }

      .tool-btn.active:hover {
        background: linear-gradient(180deg, #0b5ed7 0%, #094db0 100%);
        transform: translateY(-1px);
        box-shadow: 0 4px 10px rgba(13, 110, 253, 0.5);
      }

      .tool-btn svg {
        width: 18px;
        height: 18px;
        transition: transform 0.2s ease;
      }

      .tool-btn:hover svg {
        transform: scale(1.1);
      }

      .draw-tool-container {
        position: relative;
      }

      .draw-btn {
        position: relative;
        min-width: 90px;
      }

      .dropdown-arrow {
        width: 14px !important;
        height: 14px !important;
        margin-left: 6px;
        transition: transform 0.3s ease;
      }

      .draw-btn.active .dropdown-arrow {
        transform: rotate(180deg);
      }

      .draw-shapes-menu {
        position: absolute;
        top: calc(100% + 6px);
        left: 0;
        background: #1e1e1e;
        border: 1px solid #333;
        border-radius: 8px;
        padding: 6px;
        min-width: 180px;
        display: none;
        flex-direction: column;
        gap: 4px;
        z-index: 1000;
        box-shadow: 0 6px 16px rgba(0, 0, 0, 0.4);
        transform-origin: top center;
        animation: fadeIn 0.2s ease forwards;
      }

      .draw-shapes-menu.show {
        display: flex;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(-10px) scale(0.95);
        }
        to {
          opacity: 1;
          transform: translateY(0) scale(1);
        }
      }

      .shape-option {
        background: transparent;
        border: none;
        color: #ccc;
        padding: 10px 14px;
        border-radius: 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 13px;
        transition: all 0.2s ease;
        text-align: left;
        width: 100%;
      }

      .shape-option:hover {
        background: #2a2a2a;
        color: #fff;
        transform: translateX(3px);
      }

      .shape-option svg {
        width: 18px;
        height: 18px;
        flex-shrink: 0;
      }

      .menu-separator {
        height: 1px;
        background: #333;
        margin: 6px 0;
      }

      .close-btn {
        background: linear-gradient(180deg, #dc3545 0%, #c82333 100%);
        border-color: #c82333;
        color: #fff;
        box-shadow: 0 2px 6px rgba(220, 53, 69, 0.4);
      }

      .close-btn:hover {
        background: linear-gradient(180deg, #c82333 0%, #bd2130 100%);
        box-shadow: 0 4px 10px rgba(220, 53, 69, 0.5);
      }

      .viewer-container {
        display: flex;
        flex: 1;
        overflow: hidden;
      }

      .thumbnails-sidebar {
        width: 180px;
        background: #121212;
        border-right: 1px solid #2a2a2a;
        display: flex;
        flex-direction: column;
        transition: all 0.3s ease;
        box-shadow: 2px 0 10px rgba(0, 0, 0, 0.2);/
      }

      .thumbnails-sidebar.collapsed {
        width: 52px;
      }

      .thumbnails-sidebar.collapsed .thumbnails-list {
        display: none;
      }

      .sidebar-header {
        padding: 14px;
        border-bottom: 1px solid #2a2a2a;
        display: flex;
        justify-content: center;
      }

      .sidebar-toggle {
        background: rgba(40, 40, 40, 0.7);
        border: 1px solid #333;
        color: #ccc;
        padding: 10px;
        border-radius: 6px;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s ease;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
      }

      .sidebar-toggle:hover {
        background: #2a2a2a;
        border-color: #555;
        color: #fff;
        transform: translateY(-1px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
      }

      .thumbnails-list {
        flex: 1;
        overflow-y: auto;
        padding: 10px;
      }

      .thumbnail-item {
        background: #1a1a1a;
        border: 2px solid #333;
        border-radius: 8px;
        padding: 10px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.2);
      }

      .thumbnail-item:hover {
        border-color: #444;
        background: #1f1f1f;
        transform: translateY(-2px);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
      }

      .thumbnail-item.active {
        border-color: #0d6efd;
        background: linear-gradient(180deg, #1e3a5f 0%, #1a3452 100%);
        box-shadow: 0 2px 8px rgba(13, 110, 253, 0.3);
      }

      .thumbnail-preview {
        width: 100%;
        aspect-ratio: 1;
        background: #0a0a0a;
        border-radius: 6px;
        margin-bottom: 10px;
        overflow: hidden;
        position: relative;
      }

      .layer-group-thumbnail {
        width: 100%;
        height: 100%;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .layer-group-thumbnail > div {
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) !important;
      }

      .layer-group-thumbnail canvas {
        max-width: 100% !important;
        max-height: 100% !important;
        width: auto !important;
        height: auto !important;
        object-fit: contain;
      }

      .thumbnail-info {
        font-size: 12px;
      }

      .thumbnail-title {
        color: #fff;
        font-weight: 500;
        margin-bottom: 4px;
      }

      .thumbnail-description {
        color: #aaa;
      }

      .main-viewer {
        flex: 1;
        position: relative;
        background: #000;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      #dicom-viewport {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        overflow: hidden;
      }

      .layer-group {
        width: 100%;
        height: 100%;
        position: relative;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .layer-group > div {
        position: absolute !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) !important;
      }

      .layer-group canvas {
        max-width: 95vw !important;
        max-height: 95vh !important;
        width: auto !important;
        height: auto !important;
        object-fit: contain;
      }

      .patient-info {
        position: absolute;
        background: rgba(15, 15, 15, 0.85);
        padding: 14px 18px;
        font-size: 14px;
        z-index: 10;
        border-radius: 8px;
        backdrop-filter: blur(4px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
      }

      .patient-info.top-left {
        top: 20px;
        left: 20px;
      }

      .patient-info.top-right {
        top: 20px;
        right: 20px;
      }

      /* Bot√≥n de Ayuda */
      .help-btn {
        background: linear-gradient(180deg, #10b981 0%, #059669 100%);
        border-color: #059669;
        color: #fff;
        box-shadow: 0 2px 6px rgba(16, 185, 129, 0.4);
      }

      .help-btn:hover {
        background: linear-gradient(180deg, #059669 0%, #047857 100%);
        box-shadow: 0 4px 10px rgba(16, 185, 129, 0.5);
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        z-index: 1000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background-color: rgba(0, 0, 0, 0.7);
        backdrop-filter: blur(4px);
        animation: fadeIn 0.3s ease;
      }

      .modal.show {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
        }
        to {
          opacity: 1;
        }
      }

      .modal-content {
        background: #1a1a1a;
        border-radius: 12px;
        max-width: 700px;
        width: 90%;
        max-height: 85vh;
        overflow: hidden;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.5);
        animation: slideIn 0.3s ease;
        border: 1px solid #2a2a2a;
      }

      @keyframes slideIn {
        from {
          transform: translateY(-50px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      .modal-header {
        background: linear-gradient(180deg, #2a2a2a 0%, #1f1f1f 100%);
        padding: 20px 24px;
        border-bottom: 1px solid #333;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .modal-header h2 {
        margin: 0;
        color: #fff;
        font-size: 20px;
        font-weight: 600;
      }

      .modal-close {
        background: transparent;
        border: none;
        color: #ccc;
        font-size: 32px;
        cursor: pointer;
        padding: 0;
        width: 32px;
        height: 32px;
        display: flex;
        align-items: center;
        justify-content: center;
        border-radius: 4px;
        transition: all 0.2s ease;
      }

      .modal-close:hover {
        background: rgba(255, 255, 255, 0.1);
        color: #fff;
      }

      .modal-body {
        padding: 24px;
        overflow-y: auto;
        max-height: calc(85vh - 80px);
      }

      .help-section {
        margin-bottom: 28px;
      }

      .help-section h3 {
        color: #fff;
        font-size: 18px;
        margin-bottom: 16px;
        padding-bottom: 8px;
        border-bottom: 2px solid #333;
      }

      .help-item {
        margin-bottom: 16px;
        padding: 12px;
        background: rgba(40, 40, 40, 0.5);
        border-radius: 6px;
        border-left: 3px solid #0d6efd;
      }

      .help-item strong {
        color: #3b82f6;
        display: block;
        margin-bottom: 6px;
        font-size: 14px;
      }

      .help-item p {
        color: #ccc;
        margin: 0;
        font-size: 13px;
        line-height: 1.6;
      }

      .help-item ul {
        margin: 8px 0 0 0;
        padding-left: 20px;
        color: #ccc;
        font-size: 13px;
      }

      .help-item li {
        margin-bottom: 6px;
        line-height: 1.5;
      }

      .help-tip {
        background: linear-gradient(
          135deg,
          rgba(16, 185, 129, 0.1) 0%,
          rgba(5, 150, 105, 0.1) 100%
        );
        border: 1px solid rgba(16, 185, 129, 0.3);
        border-radius: 8px;
        padding: 16px;
        margin-top: 20px;
      }

      .help-tip strong {
        color: #10b981;
        display: block;
        margin-bottom: 6px;
      }

      .help-tip {
        color: #d1d5db;
        font-size: 13px;
        line-height: 1.6;
      }

      /* ============================================ */
      /* RESPONSIVE DESIGN - Media Queries */
      /* ============================================ */

      /* Tablets y pantallas medianas (‚â§ 1024px) */
      @media (max-width: 1024px) {
        .toolbar {
          padding: 10px 12px;
          flex-wrap: wrap;
          gap: 8px;
        }

        .tool-btn {
          padding: 6px 10px;
          font-size: 12px;
        }

        .tool-btn svg {
          width: 16px;
          height: 16px;
        }

        .tool-btn span {
          display: none;
        }

        .thumbnails-sidebar {
          width: 120px;
        }

        .thumbnails-sidebar.collapsed {
          width: 48px;
        }

        .patient-info {
          padding: 10px 14px;
          font-size: 12px;
        }

        .modal-content {
          max-width: 90%;
          width: 90%;
        }
      }

      /* Tablets peque√±as (‚â§ 768px) */
      @media (max-width: 768px) {
        body {
          overflow-x: hidden;
        }

        .toolbar {
          padding: 8px;
          gap: 6px;
        }

        .toolbar-left,
        .toolbar-right {
          gap: 6px;
        }

        .tool-btn {
          padding: 8px;
          min-width: auto;
        }

        .tool-btn span {
          display: none !important;
        }

        .draw-btn {
          min-width: auto;
        }

        .dropdown-arrow {
          margin-left: 0;
        }

        /* Ocultar sidebar de thumbnails en m√≥viles */
        .thumbnails-sidebar {
          position: absolute;
          left: -200px;
          transition: left 0.3s ease;
          z-index: 100;
          height: calc(100vh - 60px);
        }

        .thumbnails-sidebar.show-mobile {
          left: 0;
        }

        .viewer-container {
          flex-direction: column;
        }

        .main-viewer {
          width: 100%;
          height: calc(100vh - 60px);
        }

        /* Informaci√≥n del paciente m√°s compacta */
        .patient-info {
          padding: 8px 12px;
          font-size: 11px;
          max-width: 45%;
        }

        .patient-info.top-left {
          top: 10px;
          left: 10px;
        }

        .patient-info.top-right {
          top: 10px;
          right: 10px;
        }

        /* Modal m√°s peque√±o */
        .modal-content {
          max-width: 95%;
          width: 95%;
          max-height: 90vh;
        }

        .modal-header {
          padding: 16px;
        }

        .modal-header h2 {
          font-size: 18px;
        }

        .modal-body {
          padding: 16px;
          max-height: calc(90vh - 70px);
        }

        .help-section h3 {
          font-size: 16px;
        }

        .help-item {
          padding: 10px;
        }
      }

      /* M√≥viles (‚â§ 480px) */
      @media (max-width: 480px) {
        .toolbar {
          padding: 6px;
          gap: 4px;
        }

        .tool-btn {
          padding: 6px;
        }

        .tool-btn svg {
          width: 18px;
          height: 18px;
        }

        /* Hacer el men√∫ de draw m√°s compacto */
        .draw-shapes-menu {
          min-width: 150px;
          left: auto;
          right: 0;
        }

        .shape-option {
          padding: 8px 10px;
          font-size: 12px;
        }

        .shape-option svg {
          width: 16px;
          height: 16px;
        }

        /* Informaci√≥n del paciente a√∫n m√°s compacta */
        .patient-info {
          padding: 6px 10px;
          font-size: 10px;
          max-width: 48%;
          line-height: 1.3;
        }

        .patient-info div {
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        /* Modal en pantalla completa en m√≥viles */
        .modal-content {
          max-width: 100%;
          width: 100%;
          max-height: 100vh;
          border-radius: 0;
        }

        .modal-header {
          padding: 12px;
        }

        .modal-header h2 {
          font-size: 16px;
        }

        .modal-body {
          padding: 12px;
          max-height: calc(100vh - 60px);
        }

        .help-section {
          margin-bottom: 20px;
        }

        .help-section h3 {
          font-size: 15px;
          margin-bottom: 12px;
        }

        .help-item {
          padding: 8px;
          margin-bottom: 12px;
        }

        .help-item strong {
          font-size: 13px;
        }

        .help-item p,
        .help-item ul {
          font-size: 12px;
        }

        .help-tip {
          padding: 12px;
          font-size: 12px;
        }
      }

      /* Landscape en m√≥viles */
      @media (max-width: 768px) and (orientation: landscape) {
        .toolbar {
          padding: 4px 8px;
        }

        .tool-btn {
          padding: 4px 6px;
        }

        .patient-info {
          padding: 4px 8px;
          font-size: 9px;
        }

        .main-viewer {
          height: calc(100vh - 45px);
        }
      }

      /* Muy peque√±o (‚â§ 360px) */
      @media (max-width: 360px) {
        .toolbar-left,
        .toolbar-right {
          gap: 3px;
        }

        .tool-btn {
          padding: 5px;
        }

        .patient-info {
          padding: 4px 6px;
          font-size: 9px;
        }

        .help-btn span {
          display: none;
        }
      }
    </style>
  </body>
</html>
